<div class="overflow-hidden">
  {{#if this.formIsInvalid}}
    <AuAlert
      @icon="alert-triangle"
      @title="Gelieve de velden van uw bericht na te kijken"
      @skin="error">
      <ul class="au-c-bullet-list">
        {{#each-in this.showErrors.showErrorObject as |field value|}}
          {{#if value}}
            {{#if (v-get this.model field "isInvalid")}}
              <li>{{v-get this.model field "message"}}</li>
            {{/if}}
          {{/if}}
        {{/each-in}}
      </ul>
    </AuAlert>
  {{/if}}

  <form class="au-c-form">
    <AuFormRow>
      <AuLabel
        for="complaint-name"
        @error={{this.nameIsInvalid}}
        @required={{true}}
        @requiredLabel="Verplicht">
        Naam
      </AuLabel>
      <AuInput
        id="complaint-name"
        value={{this.model.name}}
        @error={{this.nameIsInvalid}}
        @width="block"
        {{on "input" (fn this.changeModel "name")}}
        {{on "focusout" (fn (mut this.showErrors.name) true)}}/>
      {{#if this.nameIsInvalid}}
        <AuHelpText
          @error={{true}}>
          Gelieve dit veld in te vullen.
        </AuHelpText>
      {{/if}}
    </AuFormRow>

    <AuFormRow>
      <AuLabel
        for="complaint-name-contact">
        Contactpersoon indien vereniging
      </AuLabel>
      <AuInput
        id="complaint-name-contact"
        value={{this.model.contactPersonName}}
        {{on "input" (fn this.changeModel "contactPersonName")}}
        @width="block"
        />
    </AuFormRow>

    <AuFormRow>
      <div class="au-u-flex-self-stretch au-o-grid au-o-grid--small">
        <div class="au-o-grid__item au-u-2-4@medium">
          <AuLabel
            for="complaint-street"
            @error={{this.streetIsInvalid}}
            @required={{true}}
            @requiredLabel="Verplicht">
            Straat
          </AuLabel>
          <AuInput
            id="complaint-street"
            value={{this.model.street}}
            @error={{this.streetIsInvalid}}
            @width="block"
            {{on "input" (fn this.changeModel "street")}}
            {{on "focusout" (fn (mut this.showErrors.street) true)}}/>
          {{#if this.streetIsInvalid}}
            <AuHelpText
              @error={{true}}>
              Gelieve dit veld in te vullen.
            </AuHelpText>
          {{/if}}
        </div>
        <div class="au-o-grid__item au-u-1-4@medium">
          <AuLabel
            for="complaint-number"
            @error={{this.houseNumberIsInvalid}}
            @required={{true}}
            @requiredLabel="Verplicht">
            Huisnummer
          </AuLabel>
          <AuInput
            id="complaint-number"
            value={{this.model.houseNumber}}
            @error={{this.houseNumberIsInvalid}}
            @width="block"
            {{on "input" (fn this.changeModel "houseNumber")}}
            {{on "focusout" (fn (mut this.showErrors.houseNumber) true)}}/>
          {{#if this.houseNumberIsInvalid}}
            <AuHelpText
              @error={{true}}>
              Geef een geldig huisnummer op.
            </AuHelpText>
          {{/if}}
        </div>
        <div class="au-o-grid__item au-u-1-4@medium">
          <AuLabel
            for="complaint-addition">
            Toevoeging
          </AuLabel>
          <AuInput
            id="complaint-addition"
            value={{this.model.addressComplement}}
            @width="block"
            {{on "input" (fn this.changeModel "addressComplement")}}/>
        </div>
      </div>
    </AuFormRow>
    <AuFormRow>
      <div class="au-u-flex-self-stretch au-o-grid au-o-grid--small">
        <div class="au-o-grid__item au-u-2-3@medium">
          <AuLabel
            for="complaint-city"
            @error={{this.localityIsInvalid}}
            @required={{true}}
            @requiredLabel="Verplicht">
            Gemeente of Stad
          </AuLabel>
          <AuInput
            id="complaint-city"
            value={{this.model.locality}}
            @error={{this.localityIsInvalid}}
            @width="block"
            {{on "input" (fn this.changeModel "locality")}}
            {{on "focusout" (fn (mut this.showErrors.locality) true)}} />
          {{#if this.localityIsInvalid}}
            <AuHelpText
              @error={{true}}>
              Gelieve dit veld in te vullen.
            </AuHelpText>
          {{/if}}
        </div>
        <div class="au-o-grid__item au-u-1-3@medium">
          <AuLabel
            for="complaint-zip"
            @error={{this.postalCodeIsInvalid}}
            @required={{true}}
            @requiredLabel="Verplicht">
            Postcode
          </AuLabel>
          <AuInput
            id="complaint-zip"
            value={{this.model.postalCode}}
            @error={{this.postalCodeIsInvalid}}
            @width="block"
            {{on "input" (fn this.changeModel "postalCode")}}
            {{on "focusout" (fn (mut this.showErrors.postalCode) true)}}/>
          {{#if this.postalCodeIsInvalid}}
            <AuHelpText
              @error={{true}}>
              Geef een geldige postcode op.
            </AuHelpText>
          {{/if}}
        </div>
      </div>
    </AuFormRow>

    <AuFormRow>
      <AuLabel
        for="complaint-phone"
        @error={{this.telephoneIsInvalid}}>
        Telefoonnummer
      </AuLabel>
      <AuInput
        id="complaint-phone"
        value={{this.model.telephone}}
        @error={{this.telephoneIsInvalid}}
        @width="block"
        {{on "input" (fn this.changeModel "telephone")}}
        {{on "focusout" (fn (mut this.showErrors.telephone) true)}}/>
      {{#if this.telephoneIsInvalid}}
        <AuHelpText
          @error={{true}}>
          Geef een geldig telefoonnummer op.
        </AuHelpText>
      {{/if}}
    </AuFormRow>

    <AuFormRow>
      <AuLabel
        for="complaint-mail"
        @error={{this.emailIsInvalid}}
        @required={{true}}
        @requiredLabel="Verplicht">
        Mailadres
      </AuLabel>
      <AuInput
        id="complaint-mail"
        value={{this.model.email}}
        @error={{this.emailIsInvalid}}
        @width="block"
        {{on "input" (fn this.changeModel "email")}}
        {{on "focusout" (fn (mut this.showErrors.email) true)}}/>
      {{#if this.emailIsInvalid}}
        <AuHelpText
          @error={{true}}>
          Geef een geldig mailadres op.
        </AuHelpText>
      {{/if}}
    </AuFormRow>

    <AuFormRow>
      <AuLabel
        for="complaint-complaint"
        @error={{this.contentIsInvalid}}
        @required={{true}}
        @requiredLabel="Verplicht">
        Omschrijving klacht
      </AuLabel>
      <AuTextarea
        id="complaint-complaint"
        value={{this.model.content}}
        @error={{this.contentIsInvalid}}
        @width="block"
        rows="5"
        {{on "input" (fn this.changeModel "content")}}
        {{on "focusout" (fn (mut this.showErrors.content) true)}} />
      {{#if this.contentIsInvalid}}
        <AuHelpText
          @error={{true}}>
          Gelieve dit veld in te vullen.
        </AuHelpText>
      {{/if}}
      <AuHelpText>
        Beschrijf zo duidelijk mogelijk wat uw klacht inhoudt: wie, wat, waar en
        wanneer. Geef aan tegen welke handelingen of beslissingen van welk bestuur
        u klacht wenst in te dienen, en wat zijn de concrete feiten/handelingen
        waarover u klacht wil indienen.
      </AuHelpText>
    </AuFormRow>

    <AuFormRow>
      <AuLabel
        for="complaint-attachment">
        Bijlagen
      </AuLabel>
        {{#each this.model.attachments as |attachment|}}
          <AuFileCard
            class="au-u-margin-bottom-small full-width"
            @filename={{attachment.filename}}
            @fileSize={{attachment.humanReadableSize}}
            @onDelete={{this.deleteFile}}/>
        {{/each}}
        <AuFileUpload
          id="complaint-attachment"
          class="full-width"
          @maxFileSizeMB={{1024}}
          @multiple={{true}}
          @onFinishUpload={{this.attachFile}}/>
    </AuFormRow>

    <div>
      {{#if this.saveComplaintError}}
        {{this.saveComplaintError}}
      {{/if}}
    </div>

    <AuButton
      @size="large"
      @disabled={{v-get this.model "isInvalid"}}
      type="submit"
      {{on "click" this.submitComplaint}}>
      Bericht verzenden
    </AuButton>
  </form>
</div>

{{outlet}}